---
source_of_truth: true
version: v1
updated: 2025-11-17
owner: tim (COO/PM)
status: draft
category: legal/data_license
---

# データ匿名化ガイド（ドラフト）

## 1. 目的

STARLISTが外部に提供する統計・集計データは、再識別リスクをゼロに近づけるための匿名化処理を施したうえで公開する。ガイドは「どの粒度でどう丸めるか」という実務の合意基準を示す。

## 2. ルール

### 2.1. 最小サンプルサイズ

- ひとつの集計グループが30件未満の場合は `その他` またはブール値でマスクする。  
- 30件未満の組み合わせが複数存在する場合は、類似カテゴリでマージして統計利便性を保つ。

### 2.2. 数値の丸め

- 金額（JPY系）は1,000円単位、スパチャなどは100円単位で丸める。  
- 変化率/スコアも小数点第2位以下は切り捨て。  
- 取得時刻は日次レベル（月/日）に丸め、タイムスタンプは省略。

### 2.3. 属性の組み合わせ制限

- 年齢/地域/カテゴリを同時に開示する場合は、各属性のカテゴリ数を制限（最大3属性）。  
- 特定の属性がクローズドな少数派（例: 特定の少数民族地域・年齢85歳以上）に該当する際は「カテゴリを統合」または「判明しない」表記。  

### 2.4. 文字列のマスク

- ユーザーID、ファンID、スターIDは常に ID トークンやハッシュで返す。  
- 特定のスターに紐づく情報は、必ず `starId` で分類し、他プロジェクトと共有する場合もマスク済み ID を転送。

## 3. APIの審査フロー

1. NEW API 企画 → 2. DATA LICENSE との整合チェック → 3. 匿名化ガイドの適用可否レビュー → 4. 開発/テスト  
不足があれば最初の段階（DATA LICENSE）で差し戻す。  

## 4. 違反時の扱い

- 本ガイドに従わず粒度の細かいデータを提供した場合は API キー停止 + ドキュメント差し替え + 違反ログ記録。  
- 監査時には「どの丸めルールを適用したか」をログとして残す。  

## 5. 参考

- ISO/IEC 20889:2018 De-identification framework をベースとし、STARLIST事業に適応。（内部メモで詳細を追加予定）
---
source_of_truth: true
version: v1
updated: 2025-11-17
owner: tim (COO/PM)
status: draft
category: legal/data_license
---

# DATA_ANONYMIZATION_GUIDE

## 1. 目的

本ガイドは「どの粒度でならSTARLISTの統計データを外部に出せるか」、技術×法務の視点で判断するための中間レイヤです。データの再識別リスクを抑えつつ、APIやレポートに使える集計のしきい値・丸めルールを事前定義します。

## 2. 基本方針

- **最小サンプルサイズ**: APIレスポンスが 30 レコード未満の場合は `others` に統合、または公開自体を見送る（例: 地域×年代の細かすぎる組み合わせ）。
- **丸め・区分**: 金額は 100 円単位または 1,000 円単位で丸め、日時は日次/週次/月次で切り捨て。
- **匿名化モード**: 必要に応じて差分プライバシー風にノイズ（±1～3％）を加える。特に `super_chat` のトップ支援者といったカテゴリでは慎重に。
- **混合属性制限**: 「地域＋年齢＋性別＋フォロワー階層」など再識別リスクの高い複合属性を含むレスポンスは、`aggregated: true` フラグを付けて曖昧化するか、追加契約により明示的に許可を得る。

## 3. 集計サンプル例

| 項目 | ルール |
| --- | --- |
| ジャンル別平均売上 | 100名以上のスターで重みづけした平均。少数の場合は `n < 100` 表記のみで数値非表示。 |
| スーパーチャット階層 | 5段階までのティアごとにカウンタを返す。各ティアは最低10件以上かつ月間売上総額の5%以上。 |
| YouTube視聴回数分布 | 10,000回〜100,000回などのバケットで表現し、1,000件未満のデータは `low sample` としてまとめる。 |

## 4. レビューと例外

- 新しいAPIが追加されるたびに、本ガイドで `aggregation_thresholds` を更新する。Change PR では `DATA_LICENSE_AND_EXTERNAL_API_POLICY.md` への参照が必要。
- 例外（例：特定の提携パートナー向けに 10 名未満のスターを含む API を出す）には、事前に法務・PM・技術の三者レビューをし、「例外ログ」を付与。

## 5. リスクパターン

- 生データをそのまま `JSON` で出力する（禁止）。
- バケットサイズが 1 ずつで細分化された表を提供し、再識別可能な組み合わせを開いてしまう。
- ログの中に `user_id` や `email` を含めたまま APIで返す（PII漏洩）。

## 6. フォローアップ

1. リリースごとに `DATA_LICENSE_AND_EXTERNAL_API_POLICY.md` と併せてアップデートし、`version`。  
2. ローカル検証ツール（例: `scripts/starlist_md_validator.py` のようなもの）を使って `docs/api/` 内の集計仕様がこのガイドに合致しているかチェックする。  
3. 外部パートナーに提供する「集計ルール表」を本ガイドから生成し、契約書類に添付。


