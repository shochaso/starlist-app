# Gitleaks configuration for Starlist
# Detects secrets and credentials in code

title = "Starlist Gitleaks Config"

[extend]
# Use default rules
useDefault = true

[[rules]]
id = "starlist-supabase-service-role"
description = "Supabase Service Role Key"
regex = '''(?i)(supabase[_-]?service[_-]?role[_-]?key|SUPABASE_SERVICE_ROLE_KEY)\s*[=:]\s*['"]?[a-zA-Z0-9_-]{40,}['"]?'''
tags = ["key", "supabase", "secret"]

[[rules]]
id = "starlist-stripe-secret"
description = "Stripe Secret Key"
regex = '''(?i)(stripe[_-]?secret[_-]?key|STRIPE_SECRET_KEY|sk_[a-zA-Z0-9]{24,})\s*[=:]\s*['"]?[a-zA-Z0-9_-]{40,}['"]?'''
tags = ["key", "stripe", "secret"]

[[rules]]
id = "starlist-slack-webhook"
description = "Slack Webhook URL"
regex = '''https://hooks\.slack\.com/services/[a-zA-Z0-9]+/[a-zA-Z0-9]+/[a-zA-Z0-9]+'''
tags = ["webhook", "slack", "secret"]

[[rules]]
id = "starlist-ops-service-secret"
description = "OPS Service Secret"
regex = '''(?i)(OPS_SERVICE_SECRET|ops[_-]?service[_-]?secret)\s*[=:]\s*['"]?[a-zA-Z0-9]{32,}['"]?'''
tags = ["secret", "ops"]

[allowlist]
description = "Allowlist for known false positives"
paths = [
  '''\.md$''',
  '''\.example$''',
  '''\.template$''',
  '''SECURITY_SWEEP\.txt$''',
  '''docs/''',
  '''ios/Podfile\.lock$''',
  '''app/dashboard/audit/page\.tsx$''',
]
regexes = [
  '''p95_latency_ms''',
  '''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9\.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inpqd3Ztb3hwYWNicHdhd2x3YnJkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDEzNTQwMzMsImV4cCI6MjA1NjkzMDAzM30\.[A-Za-z0-9_-]+''',
]
# Note: JWT token is Supabase anon key (public, safe to commit)
# Podfile.lock SHA hashes are dependency checksums (not secrets)
# p95_latency_ms is a variable name (not a secret)
# Remove by 2025-12-31 (tracked in DAY12_SOT_DIFFS.md)

